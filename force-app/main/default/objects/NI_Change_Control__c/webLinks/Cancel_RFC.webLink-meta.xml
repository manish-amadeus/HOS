<?xml version="1.0" encoding="UTF-8"?>
<WebLink xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>Cancel_RFC</fullName>
    <availability>online</availability>
    <description>Set the Change Status to &quot;Cancelled&quot;</description>
    <displayType>button</displayType>
    <linkType>javascript</linkType>
    <masterLabel>Cancel RFC</masterLabel>
    <openType>onClickJavaScript</openType>
    <protected>false</protected>
    <url>{!REQUIRESCRIPT(&quot;/soap/ajax/22.0/connection.js&quot;)}
{!REQUIRESCRIPT(&quot;/soap/ajax/22.0/apex.js&quot;)}

if (Modal.confirm(&apos;Are you sure you want to cancel this Hosted RFC?&apos;)) 
{

var rfc = new sforce.SObject(&quot;NI_Change_Control__c&quot;);
rfc.id = &quot;{!NI_Change_Control__c.Id}&quot;;
rfc.Change_Status__c = &quot;Cancelled&quot;;

var result = sforce.connection.update([rfc]);

if (result[0].getBoolean(&quot;success&quot;))
{
    // Refresh window
    window.location.reload();
}
else
{
    alert(&quot;Error saving rfc&quot;);
}
}</url>
</WebLink>
