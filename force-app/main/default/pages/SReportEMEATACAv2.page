<apex:page standardController="StatusReport__c" extensions="StatusReportForm" renderAs="{!if($CurrentPage.parameters.p == null, null, 'pdf')}">

    <apex:form id="SReport">

        <apex:sectionHeader subtitle="Status Report" title="NI Support"></apex:sectionHeader>

        <apex:pageBlock title="EMEA TAC Analyst v2 Status Report" mode="edit">

            <apex:pageMessages />

            <apex:pageBlockButtons id="pbButtons" rendered="{!ShowButtons}">
                <apex:commandButton action="{!edit}" value="Edit"/>
                <apex:commandButton action="{!cancel}" value="Cancel"/>
                <apex:commandButton action="{!send}" value="Email Associate" />
            </apex:pageBlockButtons>            

            <a href="{!$CurrentPage.name}?p=pdf&id={!$CurrentPage.parameters.id}" Target="_blank">
                <apex:image url="{!$Resource.PDFIcon}" width="24" height="24" />&nbsp;View As PDF
            </a>

            <apex:pageBlockSection title="Associate Details:" collapsible="False" columns="1">

                <apex:pageBlockSectionItem id="Associate">
                    <apex:outputLabel >Associate Name:</apex:outputLabel>
                    <apex:outputField id="txtAssociate" value="{!StatusReport__c.Associate__c}" />
                </apex:pageBlockSectionItem>

                <apex:pageBlockSectionItem id="LastReportDate">
                    <apex:outputLabel >Last Report Date:</apex:outputLabel>
                    <apex:outputLabel id="txtLastReportDate" value="{!LastReportDate}" />
                </apex:pageBlockSectionItem>
                
                <apex:pageBlockSectionItem id="lblRecordTypeId">
                    <apex:outputLabel >Record Type:</apex:outputLabel>
                    <apex:outputField id="txtRecordTypeId" value="{!StatusReport__c.RecordTypeId}" />
                </apex:pageBlockSectionItem>
                
            </apex:pageBlockSection>
 
 
 
            
            <apex:pageBlockSection title="1. Customer Updates (% of Non-Overdue Cases):" collapsible="False" columns="1"> 
                <apex:outputLabel value="Do 90% of your cases, on average, have an update to your customer within the last 48 hrs?" style="font-style: italic;" />
            </apex:pageBlockSection>
            
            <apex:pageBlockSection title="1. Details:" collapsible="False" columns="2" showHeader="false">  

                <apex:pageBlockSectionItem id="Value01">
                    <apex:outputLabel >% of Non-Overdue Cases:</apex:outputLabel>
                    <apex:outputField id="txtValue01" value="{!StatusReport__c.Value01__c}" />
                </apex:pageBlockSectionItem>

                <apex:outputLabel />
                
                <apex:pageBlockSectionItem id="DidNotMeet01" >
                    <apex:outputLabel rendered="{!StatusReport__c.Missed01__c}" >Below 90% Did Not Meet:</apex:outputLabel>
                    <apex:outputField id="txtDidNotMeet01" value="{!StatusReport__c.Missed01__c}" rendered="{!StatusReport__c.Missed01__c}" />
                </apex:pageBlockSectionItem>

                <apex:outputLabel />
                
                <apex:pageBlockSectionItem id="Meets01" >
                    <apex:outputLabel rendered="{!StatusReport__c.Meets01__c}" >90% - 94% Meets:</apex:outputLabel>
                    <apex:outputField id="txtMeets01" value="{!StatusReport__c.Meets01__c}" rendered="{!StatusReport__c.Meets01__c}" />
                </apex:pageBlockSectionItem>
                
                <apex:outputLabel />
                                
                <apex:pageBlockSectionItem id="Exceeds01" >
                    <apex:outputLabel rendered="{!StatusReport__c.Exceeds01__c}" >Above 94% Exceeds:</apex:outputLabel>
                    <apex:outputField id="txtExceeds01" value="{!StatusReport__c.Exceeds01__c}" rendered="{!StatusReport__c.Exceeds01__c}" />
                </apex:pageBlockSectionItem>
                      
                <apex:outputLabel />

                <apex:pageBlockSectionItem id="Score01">
                    <apex:outputLabel >Score:</apex:outputLabel>
                    <apex:outputField id="txtScore01" value="{!StatusReport__c.Score01__c}" />
                </apex:pageBlockSectionItem>  

                <apex:outputLabel />
                                                
            </apex:pageBlockSection>




            <apex:pageBlockSection title="2. Case Age Performance:" collapsible="False" columns="1">                 
                <apex:outputLabel value="Percentage of Cases < 10 days old." style="font-style: italic;" />
            </apex:pageBlockSection>
            
            <apex:pageBlockSection title="2. Details:" collapsible="False" columns="2" showHeader="false">  
                
                <apex:pageBlockSectionItem id="Value02" >
                    <apex:outputLabel >10 Days and Below %:</apex:outputLabel>
                    <apex:outputField id="txtValue02" value="{!StatusReport__c.Value02__c}" />
                </apex:pageBlockSectionItem>

                <apex:outputLabel />
                                
                <apex:pageBlockSectionItem id="DidNotMeet02" >
                    <apex:outputLabel rendered="{!StatusReport__c.Missed02__c}" >Under 80% Did Not Meet:</apex:outputLabel>
                    <apex:outputField id="txtDidNotMeet02" value="{!StatusReport__c.Missed02__c}" rendered="{!StatusReport__c.Missed02__c}" />
                </apex:pageBlockSectionItem>
                
                <apex:outputLabel />
                
                <apex:pageBlockSectionItem id="Meets02">
                    <apex:outputLabel rendered="{!StatusReport__c.Meets02__c}" >80% - 89% Meets:</apex:outputLabel>
                    <apex:outputField id="txtMeets02" value="{!StatusReport__c.Meets02__c}" rendered="{!StatusReport__c.Meets02__c}" />
                </apex:pageBlockSectionItem> 

                <apex:outputLabel />
                                
                <apex:pageBlockSectionItem id="Exceeds02">
                    <apex:outputLabel rendered="{!StatusReport__c.Exceeds02__c}" >90+% Exceeds:</apex:outputLabel>
                    <apex:outputField id="txtExceeds02" value="{!StatusReport__c.Exceeds02__c}" rendered="{!StatusReport__c.Exceeds02__c}" />
                </apex:pageBlockSectionItem>
                
                <apex:outputLabel />

                <apex:pageBlockSectionItem id="Score02">
                    <apex:outputLabel >Score:</apex:outputLabel>
                    <apex:outputField id="txtScore02" value="{!StatusReport__c.Score02__c}" style="width: 30px;" />
                </apex:pageBlockSectionItem>   
                
                <apex:outputLabel />
                
            </apex:pageBlockSection>

            
            <apex:pageBlockSection title="3. Make Busy Time:" collapsible="False" columns="1"> 
                <apex:outputLabel value="Was time spent on Make Busy (not counting training & meetings) at 20% or less?" style="font-style: italic;" />
            </apex:pageBlockSection>
            
            <apex:pageBlockSection title="3. Details:" collapsible="False" columns="2" showHeader="false">  

                <apex:pageBlockSectionItem id="Value03">
                    <apex:outputLabel >Make Busy %:</apex:outputLabel>
                    <apex:outputField id="txtValue03" value="{!StatusReport__c.Value03__c}" />
                </apex:pageBlockSectionItem>

                <apex:outputLabel />

                <apex:pageBlockSectionItem id="DidNotMeet03">
                    <apex:outputLabel rendered="{!StatusReport__c.Missed03__c}" >Above 20% Did Not Meet:</apex:outputLabel>
                    <apex:outputField id="txtDidNotMeet03" value="{!StatusReport__c.Missed03__c}" rendered="{!StatusReport__c.Missed03__c}" />
                </apex:pageBlockSectionItem>
                
                <apex:outputLabel />
                
                <apex:pageBlockSectionItem id="Meets03">
                    <apex:outputLabel rendered="{!StatusReport__c.Meets03__c}" >15% - 20% Meets:</apex:outputLabel>
                    <apex:outputField id="txtMeets03" value="{!StatusReport__c.Meets03__c}" rendered="{!StatusReport__c.Meets03__c}" />
                </apex:pageBlockSectionItem>
                
                <apex:outputLabel />
                                
                <apex:pageBlockSectionItem id="Exceeds03">
                    <apex:outputLabel rendered="{!StatusReport__c.Exceeds03__c}" >Below 15% Exceeds:</apex:outputLabel>
                    <apex:outputField id="txtExceeds03" value="{!StatusReport__c.Exceeds03__c}" rendered="{!StatusReport__c.Exceeds03__c}" />
                </apex:pageBlockSectionItem>
                
                <apex:outputLabel />
                
                <apex:pageBlockSectionItem id="Score03">
                    <apex:outputLabel >Score:</apex:outputLabel>
                    <apex:outputField id="txtScore03" value="{!StatusReport__c.Score03__c}" style="width: 30px;" />
                </apex:pageBlockSectionItem>      
                
                <apex:outputLabel />                            
                
            </apex:pageBlockSection>




            <apex:pageBlockSection title="4. Same Day (24hr) Case Closures (YTD):" collapsible="False" columns="1"> 
                <apex:outputLabel value="Are you able to close at least 63% of cases within 24 hours?" style="font-style: italic;" />
            </apex:pageBlockSection>
            
            <apex:pageBlockSection title="4. Details:" collapsible="False" columns="2" showHeader="false">                
                
                <apex:pageBlockSectionItem id="Value04">
                    <apex:outputLabel >Sameday Closure %:</apex:outputLabel>
                    <apex:outputField id="txtValue04" value="{!StatusReport__c.Value04__c}" />
                </apex:pageBlockSectionItem>

                <apex:outputLabel />
                                
                <apex:pageBlockSectionItem id="DidNotMeet04">
                    <apex:outputLabel rendered="{!StatusReport__c.Missed04__c}" >Below 63% Did Not Meet:</apex:outputLabel>
                    <apex:outputField id="txtDidNotMeet04" value="{!StatusReport__c.Missed04__c}" rendered="{!StatusReport__c.Missed04__c}" />
                </apex:pageBlockSectionItem>
    
                <apex:outputLabel />
                
                <apex:pageBlockSectionItem id="Meets04">
                    <apex:outputLabel rendered="{!StatusReport__c.Meets04__c}" >63% - 63.99% Meets:</apex:outputLabel>
                    <apex:outputField id="txtMeets04" value="{!StatusReport__c.Meets04__c}" rendered="{!StatusReport__c.Meets04__c}" />
                </apex:pageBlockSectionItem> 
                
                <apex:outputLabel />
                
                <apex:pageBlockSectionItem id="Exceeds04">
                    <apex:outputLabel rendered="{!StatusReport__c.Exceeds04__c}" >Above 64% Exceeds:</apex:outputLabel>
                    <apex:outputField id="txtExceeds04" value="{!StatusReport__c.Exceeds04__c}" rendered="{!StatusReport__c.Exceeds04__c}" />
                </apex:pageBlockSectionItem> 
                
                <apex:outputLabel />
                                
                <apex:pageBlockSectionItem id="Score04">
                    <apex:outputLabel >Score:</apex:outputLabel>
                    <apex:outputField id="txtScore04" value="{!StatusReport__c.Score04__c}" style="width: 30px;" />
                </apex:pageBlockSectionItem>                
                
                <apex:outputLabel />                
                
            </apex:pageBlockSection>


            <apex:pageBlockSection title="5. Overall Customer Satisfaction:" collapsible="False" columns="1"> 
                <apex:outputLabel value="Are your customers giving survey scores based on your performance averaging 8.6% or above?" style="font-style: italic;" />
            </apex:pageBlockSection>

            <apex:pageBlockSection title="5. Details:" collapsible="False" columns="2" showHeader="false">                

                <apex:pageBlockSectionItem id="Value05">
                    <apex:outputLabel >Survey Score:</apex:outputLabel>
                    <apex:outputField id="txtValue05" value="{!StatusReport__c.Value05__c}" />
                </apex:pageBlockSectionItem>

                <apex:outputLabel />
                                
                <apex:pageBlockSectionItem id="DidNotMeet05">
                    <apex:outputLabel rendered="{!StatusReport__c.Missed05__c}" >Below 8.6% Did Not Meet:</apex:outputLabel>
                    <apex:outputField id="txtDidNotMeet05" value="{!StatusReport__c.Missed05__c}" rendered="{!StatusReport__c.Missed05__c}" />
                </apex:pageBlockSectionItem>

                <apex:outputLabel />
                
                <apex:pageBlockSectionItem id="Meets05">
                    <apex:outputLabel rendered="{!StatusReport__c.Meets05__c}">8.6% Meets:</apex:outputLabel>
                    <apex:outputField id="txtMeets05" value="{!StatusReport__c.Meets05__c}" rendered="{!StatusReport__c.Meets05__c}" />
                </apex:pageBlockSectionItem> 

                <apex:outputLabel />
                
                <apex:pageBlockSectionItem id="Exceeds05">
                    <apex:outputLabel rendered="{!StatusReport__c.Exceeds05__c}" >Above 8.6% Exceeds:</apex:outputLabel>
                    <apex:outputField id="txtExceeds05" value="{!StatusReport__c.Exceeds05__c}" rendered="{!StatusReport__c.Exceeds05__c}" />
                </apex:pageBlockSectionItem>    
                
                <apex:outputLabel />
                
                <apex:pageBlockSectionItem id="Score05">
                    <apex:outputLabel >Score:</apex:outputLabel>
                     <apex:outputField id="txtScore05" value="{!StatusReport__c.Score05__c}" style="width: 30px;" />
                </apex:pageBlockSectionItem>
                
                <apex:outputLabel />
                
            </apex:pageBlockSection>




            <apex:pageBlockSection title="6. Case Notes Structure/Contents:" collapsible="False" columns="1">                 
                <apex:outputLabel value="Are you documenting action steps so others can easily follow up?" style="font-style: italic;" />
            </apex:pageBlockSection>
            
            <apex:pageBlockSection title="6. Details:" collapsible="False" columns="2" showHeader="false">  
                
                <apex:pageBlockSectionItem id="DidNotMeet06">
                    <apex:outputLabel rendered="{!StatusReport__c.Missed06__c}" >No:</apex:outputLabel>
                    <apex:outputField id="txtDidNotMeet06" value="{!StatusReport__c.Missed06__c}" rendered="{!StatusReport__c.Missed06__c}" />
                </apex:pageBlockSectionItem>
                
                <apex:outputLabel />
                
                <apex:pageBlockSectionItem id="Meets06">
                    <apex:outputLabel rendered="{!StatusReport__c.Meets06__c}" >Yes:</apex:outputLabel>
                    <apex:outputField id="txtMeets06" value="{!StatusReport__c.Meets06__c}" rendered="{!StatusReport__c.Meets06__c}" />
                </apex:pageBlockSectionItem> 

                <apex:outputLabel />

                <apex:pageBlockSectionItem id="Score06">
                    <apex:outputLabel >Score:</apex:outputLabel>
                    <apex:outputField id="txtScore06" value="{!StatusReport__c.Score06__c}" style="width: 30px;" />
                </apex:pageBlockSectionItem>   
                
                <apex:outputLabel />

            </apex:pageBlockSection>




            <apex:pageBlockSection title="7. Case Closure Confirmation:" collapsible="False" columns="1">
                <apex:outputLabel value="Does each closed case indicate direct communication with client on resolution or workaround?" style="font-style: italic;" />
            </apex:pageBlockSection>
            
            <apex:pageBlockSection title="7. Details:" collapsible="False" columns="2" showHeader="false">                
                
                <apex:pageBlockSectionItem id="DidNotMeet07">
                    <apex:outputLabel rendered="{!StatusReport__c.Missed07__c}" >No:</apex:outputLabel>
                    <apex:outputField id="txtDidNotMeet07" value="{!StatusReport__c.Missed07__c}" rendered="{!StatusReport__c.Missed07__c}" />
                </apex:pageBlockSectionItem>
                
                <apex:outputLabel />
                
                <apex:pageBlockSectionItem id="Meets07">
                    <apex:outputLabel rendered="{!StatusReport__c.Meets07__c}" >Yes:</apex:outputLabel>
                    <apex:outputField id="txtMeets07" value="{!StatusReport__c.Meets07__c}" rendered="{!StatusReport__c.Meets07__c}" />
                </apex:pageBlockSectionItem> 

                <apex:outputLabel />

                <apex:pageBlockSectionItem id="Score07">
                    <apex:outputLabel >Score:</apex:outputLabel>
                    <apex:outputField id="txtScore07" value="{!StatusReport__c.Score07__c}" style="width: 30px;" />
                </apex:pageBlockSectionItem>
                
                <apex:outputLabel />

            </apex:pageBlockSection>




            <apex:pageBlockSection title="Overall Results:" collapsible="False" columns="2"> 
                                
                <apex:pageBlockSectionItem id="FinalStatus">
                    <apex:outputLabel >Final Status:</apex:outputLabel>                
                    <apex:outputField value="{!StatusReport__c.FinalStatus__c}"/>
                </apex:pageBlockSectionItem>   

                <apex:outputLabel />
                                
                <apex:pageBlockSectionItem id="FinalScore">
                    <apex:outputLabel >Final Score:</apex:outputLabel>
                    <apex:outputField id="txtResults" value="{!StatusReport__c.Score_Final__c}" style="width: 30px;" />
                </apex:pageBlockSectionItem>                
                
                <apex:outputLabel />                
                
            </apex:pageBlockSection>

            <apex:pageBlockSection title="Final Comments:" collapsible="False" columns="1" showHeader="false">  

                <apex:pageBlockSectionItem id="CommentFinal">
                    <apex:outputLabel >Manager Comments:</apex:outputLabel>
                    <apex:outputField id="txtCommentFinal" style="width: 90%;" value="{!StatusReport__c.CommentFinal__c}" />
                </apex:pageBlockSectionItem>
                
            </apex:pageBlockSection>   

        </apex:pageBlock>
  
    </apex:form>

</apex:page>