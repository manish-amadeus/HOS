<apex:page controller="AH_UTIL_ResetPassword_Ctlr" showHeader="false" sidebar="false" lightningStylesheets="true" applyHtmlTag="false" applyBodyTag="false" docType="html-5.0">
          
    <html xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" lang="en">
        <head>
            <meta charset="utf-8" />
            <meta http-equiv="x-ua-compatible" content="ie=edge" />
            <title>Salesforce User Password Reset</title>
            <meta name="viewport" content="width=device-width, initial-scale=1" />
			<apex:stylesheet value="/apexpages/slds/latest/assets/styles/salesforce-lightning-design-system-vf.css" />
            <apex:includeScript value="{!$Resource.Toast}"/>
            <apex:slds />
        </head>

        <script language="JavaScript" type="text/javascript"> 
			
            function getDetails()  
            {
                afGetUserDetails(); 
            } 
        
        </script>
        
        <div id="divMain" class="slds-scope" style="margin: 10px 10px 10px 10px; !important;">

            <apex:form id="frmMain">                
    
                <apex:actionFunction id="afGetUserDetails" name="afGetUserDetails" action="{!pageRefUserDetail}" rerender="btnReset,btnClrMobile,btnUnlockUser,opUserDetails,apMsg" status="asStatus" />            

                <div id="divSearch" class="roundedContainer">
                    
                    <span class="slds-icon_container slds-icon-standard-address"> 
                        <svg aria-hidden="false" class="slds-icon">    
                            <use xlink:href="/apexpages/slds/latest/assets/icons/utility-sprite/svg/symbols.svg#user"></use>
                        </svg> 
                        <span class="slds-assistive-text">Salesforce User Password Reset</span> 
                    </span> 
                    &nbsp;&nbsp; 
                    <apex:outputLabel id="lblSearchTitle" value="Salesforce User Password Reset Utility" style="font-weight:bold;font-size:14pt;!important;" />
                    <br/>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    <apex:outputLabel id="lblVersion" value="August 2021 Release" style="font-weight:bold;font-size:8pt;!important;" />
                    <br/>
                    <br/>
                    <apex:outputLabel id="lblInstructions" value="{!$Label.Reset_Password_Utility_Instructions}" escape="false" style="display:block;margin-left:50px;font-size:10pt;!important;" />
                    <br/>                    
                    <apex:pageMessages id="apMsg"></apex:pageMessages>   

                    <apex:outputPanel id="opSearch">
                        <br/>
                        <br/>
                        <table>
                            <tr>
                                <td style="width:440px">
                                    <div class="slds-form-element slds-form-element_horizontal" style="padding-top:10px;padding-left:75px;width:400px;">
                                        <label class="slds-form-element__label" for="ddlUsers">User:</label>
                                        <div class="slds-form-element__control">
                                            <div class="slds-select_container">
                                                <apex:selectList id="ddlUsers" label="lblValidUsers" value="{!selUser}" styleClass="slds-select" style="width:215px;" size="1" multiselect="false" onchange="getDetails();"> 
                                                    <apex:selectOptions value="{!lstValidUsers}" /> 
                                                </apex:selectList> 
                                            </div>
                                        </div>
                                    </div>
                                </td>
                                <td>
                                    <apex:commandButton id="btnReset" value="Reset Selected User's Salesforce Password" action="{!confirmReset}" rerender="opSearch,lblMsg,opDlg1,opUserDetails,apMsg" disabled="{!bDisableResetPwdBtn}" status="asStatus" styleClass="slds-button slds-button_outline-brand" />
                                    <apex:commandButton id="btnClrMobile" value="Clear Selected User's Mobile Number" action="{!confirmMobileUpdate}" rerender="opSearch,lblMsg,opDlg2,opUserDetails,apMsg" disabled="{!bDisableClearMobilePhoneBtn}" status="asStatus" styleClass="slds-button slds-button_outline-brand" /> 
                                    <apex:commandButton id="btnUnlockUser" value="Unlock User Record" action="{!confirmUserUnlock}" rerender="opSearch,lblMsg,opDlg3,opUserDetails,apMsg" disabled="{!bDisableUnlockBtn}" status="asStatus" styleClass="slds-button slds-button_outline-brand" />
                                </td>
                            </tr>
                            <tr>
                                <td>
                                </td>
                                <td>
                                    <apex:outputLabel id="lblMsg" value="{!strErrorMsg}" style="color:red;padding-top:10px;" />     
                                </td>
                            </tr>
                        </table>
                    </apex:outputPanel>
                    
                    <br/>
                    
                    <apex:outputPanel id="opUserDetails" >
                        <div id="divUserDetail" class="roundedContainer" style="{!IF(bShowDetail, 'display:block;', 'display:none;')}background:#FEF9E7;width:50%;margin-left:20px;margin-right:20px; !important;">
                            <apex:outputLabel id="lblUserDetail" value="Selected User Details:" styleClass="slds-text-heading_medium slds-text-title_bold" />
                            <br/>
                            <table style="width:600px;border-spacing:10px;border-collapse:separate; !important;">
                                <tr>
                                    <td style="width:200px;text-align:right;font-weight:bold; !important;">
                                        User License Type:
                                    </td>
                                    <td style="width:400px;text-align:left; !important;">
                                        <apex:outputText value="{!selUserDetail.userLicenseType}" />
                                    </td>
                                </tr>
                                <tr>
                                    <td style="width:200px;text-align:right;font-weight:bold; !important;">
                                        User Name:
                                    </td>
                                    <td style="width:400px;text-align:left; !important;">
                                        <apex:outputText value="{!selUserDetail.userUsername}" />
                                    </td>
                                </tr>
                                <tr>
                                    <td style="width:200px;text-align:right;font-weight:bold; !important;">
                                        Email:
                                    </td>
                                    <td style="width:400px;text-align:left; !important;">
                                        <apex:outputText value="{!selUserDetail.userEmail}" />
                                    </td>
                                </tr>
                                <tr>
                                    <td style="width:200px;text-align:right;font-weight:bold; !important;">
                                        Mobile:
                                    </td>
                                    <td style="width:400px;text-align:left; !important;">
                                        <apex:outputText value="{!selUserDetail.userMobilePhone}" />
                                    </td>
                                </tr>
                                <tr>
                                    <td style="width:200px;text-align:right;font-weight:bold; !important;">
                                        Last Login Date:
                                    </td>
                                    <td style="width:400px;text-align:left; !important;">
                                        <apex:outputText value="{0, date, EEEE MMMM d, yyyy h:mm a}"> 
                                            <apex:param value="{!selUserDetail.LastLoginDate}" /> 
                                        </apex:outputText>
                                    </td>
                                </tr>
                                <tr>
                                    <td style="width:200px;text-align:right;font-weight:bold;color:{! IF(selUserDetail.isFrozen, '#FF0000', '#000000')}; !important;">
                                        User is Frozen:
                                    </td>
                                    <td style="width:400px;text-align:left; !important;">
                                        <apex:inputCheckbox value="{!selUserDetail.IsFrozen}" disabled="true" />
                                    </td>
                                </tr>
                                <tr>
                                    <td style="width:200px;text-align:right;font-weight:bold;color:{! IF(selUserDetail.isLocked, '#FF0000', '#000000')}; !important;">
                                        User is Locked:
                                    </td>
                                    <td style="width:400px;text-align:left; !important;">
                                        <apex:inputCheckbox value="{!selUserDetail.IsLocked}" disabled="true" />
                                    </td>
                                </tr>
                                <tr>
                                    <td style="width:200px;text-align:right;font-weight:bold;color:{! IF(selUserDetail.isChangedLast24hrs, '#FF0000', '#000000')}; !important;">
                                        Last Password Change Date:
                                    </td>
                                    <td style="width:400px;text-align:left; !important;">
                                        <apex:outputText value="{0, date, EEEE MMMM d, yyyy h:mm a}"> 
                                            <apex:param value="{!selUserDetail.LastPasswordChangeDate}" /> 
                                        </apex:outputText>
                                    </td>
                                </tr>
                            </table>
                            <br/>
                        </div>
                    </apex:outputPanel>
                    <br/>
                </div>                

            
                <!-- SPINNER -->  
                <apex:actionstatus id="asStatus">
                    <apex:facet name="start">
                        <div class="slds-spinner_container">
                            <div role="status" class="slds-spinner slds-spinner_medium slds-spinner_brand">
                                <span class="slds-assistive-text">Loading</span>
                                <div class="slds-spinner__dot-a"></div>
                                <div class="slds-spinner__dot-b"></div>
                            </div>
                        </div>
                    </apex:facet>
                </apex:actionstatus>                
                
                
                
                <!-- MODAL DIALOG 1 -->                
                <apex:outputPanel id="opDlg1">
                    <apex:outputPanel styleClass="popupBackground" layout="block" rendered="{!displayDialog1}" />
                    <apex:outputPanel styleClass="popupDialogBox" layout="block" rendered="{!displayDialog1}">

                        <apex:commandButton id="cmdXBtn1" value="X" action="{!hideDialog1}" status="asModalStatus" rerender="opDlg1,opSearch,opSuccess" style="position:absolute;left:1170px;top:-40px;font-size:24px;border:3px solid white;border-radius: 5px;!important;" styleClass="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" />
                        
                        <!-- SPINNER -->  
                        <apex:actionstatus id="asModalStatus">
                            <apex:facet name="start">
                                <div class="slds-spinner_container">
                                    <div role="status" class="slds-spinner slds-spinner_medium slds-spinner_brand">
                                        <span class="slds-assistive-text">Saving</span>
                                        <div class="slds-spinner__dot-a"></div>
                                        <div class="slds-spinner__dot-b"></div>
                                    </div>
                                </div>
                            </apex:facet>
                        </apex:actionstatus>                          
                        
                        <header class="slds-modal__header">
                            <h2 class="slds-text-heading_medium slds-hyphenate" id="modal-heading-01">Reset Password Confirmation</h2>
                        </header>                        
    					<br /> 
                        <div id="divSelected" class="roundedContainer" style="position:relative;text-align:center;">
                            <apex:outputText value="{!strConfirmationMsg}" />
							<br />
                            <br />
                            <br />
                            <apex:commandButton id="cmdCancel" value="Cancel Reset" action="{!hideDialog1}" status="asModalStatus" rerender="opDlg1,opSearch,opSuccess" styleClass="slds-button slds-button_outline-brand" />&nbsp;
                            <apex:commandButton id="cmdSubmit" value="Submit Reset" action="{!submitDialog1}" status="asModalStatus" Oncomplete="getDetails" rerender="opDlg1,opSearch,opSuccess,opUserDetails,apMsg" styleClass="slds-button slds-button_brand" />                           
                            <br />
                        </div>                
                
                        <br />
                    </apex:outputPanel>
                </apex:outputPanel>                     
                
                <!-- MODAL DIALOG 2 -->                
                <apex:outputPanel id="opDlg2">
                    <apex:outputPanel styleClass="popupBackground" layout="block" rendered="{!displayDialog2}" />
                    <apex:outputPanel styleClass="popupDialogBox" layout="block" rendered="{!displayDialog2}">

                        <apex:commandButton id="cmdXBtn2" value="X" action="{!hideDialog2}" status="asModalStatus2" rerender="opDlg2,opSearch,opSuccess" style="position:absolute;left:1170px;top:-40px;font-size:24px;border:3px solid white;border-radius: 5px;!important;" styleClass="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" />
                        
                        <!-- SPINNER -->  
                        <apex:actionstatus id="asModalStatus2">
                            <apex:facet name="start">
                                <div class="slds-spinner_container">
                                    <div role="status" class="slds-spinner slds-spinner_medium slds-spinner_brand">
                                        <span class="slds-assistive-text">Saving</span>
                                        <div class="slds-spinner__dot-a"></div>
                                        <div class="slds-spinner__dot-b"></div>
                                    </div>
                                </div>
                            </apex:facet>
                        </apex:actionstatus>                          
                        
                        <header class="slds-modal__header">
                            <h2 class="slds-text-heading_medium slds-hyphenate" id="modal-heading-01">Clear Mobile Phone Confirmation</h2>
                        </header>                        
    					<br /> 
                        <div id="divSelected" class="roundedContainer" style="position:relative;text-align:center;">
                            <apex:outputText value="{!strConfirmationMsg}" />
							<br />
                            <br />
                            <br />
                            <apex:commandButton id="cmdCancel2" value="Cancel Mobile Update" action="{!hideDialog2}" status="asModalStatus" rerender="opDlg2,opSearch,opSuccess" styleClass="slds-button slds-button_outline-brand" />&nbsp;
                            <apex:commandButton id="cmdSubmit2" value="Submit Mobile Update" action="{!submitDialog2}" status="asModalStatus2" rerender="opDlg2,opSearch,opSuccess,opUserDetails,apMsg" styleClass="slds-button slds-button_brand" />                           
                            <br />
                        </div>                
                
                        <br />
                    </apex:outputPanel>
                </apex:outputPanel>
                
                <!-- MODAL DIALOG 3 -->                
                <apex:outputPanel id="opDlg3">
                    <apex:outputPanel styleClass="popupBackground" layout="block" rendered="{!displayDialog3}" />
                    <apex:outputPanel styleClass="popupDialogBox" layout="block" rendered="{!displayDialog3}">

                        <apex:commandButton id="cmdXBtn3" value="X" action="{!hideDialog3}" status="asModalStatus3" rerender="opDlg3,opSearch,opSuccess" style="position:absolute;left:1170px;top:-40px;font-size:24px;border:3px solid white;border-radius: 5px;!important;" styleClass="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" />
                        
                        <!-- SPINNER -->  
                        <apex:actionstatus id="asModalStatus3">
                            <apex:facet name="start">
                                <div class="slds-spinner_container">
                                    <div role="status" class="slds-spinner slds-spinner_medium slds-spinner_brand">
                                        <span class="slds-assistive-text">Saving</span>
                                        <div class="slds-spinner__dot-a"></div>
                                        <div class="slds-spinner__dot-b"></div>
                                    </div>
                                </div>
                            </apex:facet>
                        </apex:actionstatus>                          
                        
                        <header class="slds-modal__header">
                            <h2 class="slds-text-heading_medium slds-hyphenate" id="modal-heading-01">Unlock User Record</h2>
                        </header>                        
    					<br /> 
                        <div id="divSelected" class="roundedContainer" style="position:relative;text-align:center;">
                            <apex:outputText value="{!strConfirmationMsg}" />
							<br />
                            <br />
                            <br />
                            <apex:commandButton id="cmdCancel3" value="Cancel Unlock User Record" action="{!hideDialog3}" status="asModalStatus3" rerender="opDlg3,opSearch,opSuccess" styleClass="slds-button slds-button_outline-brand" />&nbsp;
                            <apex:commandButton id="cmdSubmit3" value="Submit Unlock User Record" action="{!submitDialog3}" status="asModalStatus3" Oncomplete="getDetails" rerender="opDlg3,opSuccess,opSearch,opUserDetails,apMsg" styleClass="slds-button slds-button_brand" />                           
                            <br />
                        </div>                
                
                        <br />
                    </apex:outputPanel>
                </apex:outputPanel>      
                
                
                <!-- SUCCESS POPUP -->
                <apex:outputPanel id="opSuccess" styleClass="popupSuccessFade fadeOut">
                    <apex:outputPanel styleClass="popupSuccess" layout="block" rendered="{!isSuccess}">
                        <div class="slds-notify_container slds-is-relative">
                            <div class="slds-notify slds-notify_toast slds-theme_success" role="alert">
                                <span class="slds-assistive-text">success</span>
                                <span class="slds-icon_container slds-icon-utility-success slds-m-right_small slds-no-flex slds-align-top" title="">
                                    <svg class="slds-icon slds-icon_small" aria-hidden="true">
                                        <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="/apexpages/slds/latest/assets/icons/utility-sprite/svg/symbols.svg#success" />
                                    </svg>
                                </span>
                                <div class="slds-notify__content">
                                    <h2 class="slds-text-heading_small ">
                                        <apex:outputLabel id="lblToastMsg" value="{!toastMsg}" />
                                    </h2>
                                </div>
                            </div>
                        </div>            
                    </apex:outputPanel>
                </apex:outputPanel> 

                
                
            </apex:form>

        </div>
        
        <style type="text/css"> 
            .popupDialogBox 
            {      
            	position: absolute;
                background-color: white;
            	border-radius: 5px;
                top: 100px;
                left: 50%;
                width: 1200px;
                margin-left: -600px;
                z-index: 9999;
                padding: 10px; 
            }                
            .popupBackground 
            {          
            	position: fixed;
                width: 100%;
                height: 100%;
                top: 0;
                right: 0;
                bottom: 0;
                left: 0;
                z-index: calc(9000 + 2);
                background-color: rgba(0,0,0,.1);
                visibility: visible;
                opacity: 1;
                transition: opacity .2s ease,visibility 0s;
                transition-delay: 0s,.3s; 
            }
            .popupSuccess
            {      
            	position: absolute;
				color: white;
      			background-color: #04844b; 
            	border-radius: 5px;
                top: 30px;
                left: 50%;
                width: 500px;
                margin-left: -250px;
                z-index: 9999;
                padding: 0px;       
            } 
            .popupSuccessFade
            {      
                -webkit-animation-duration: 5s;animation-duration: 5s;
                -webkit-animation-fill-mode: both;animation-fill-mode: both;
            }
            @-webkit-keyframes fadeOut 
            {
                0% {opacity: 1;}
                100% {opacity: 0;}
            }
            @keyframes fadeOut 
            {
                0% {opacity: 1;}
                100% {opacity: 0;}
            }
            .fadeOut 
            {
                -webkit-animation-name: fadeOut;
                animation-name: fadeOut;
            }            
            .roundedContainer
            {
                width: 100%;
                border: 1px solid lightgrey;
                padding: 10px;
                border-radius: 5px;
                !important;
            }
            .slds-spinner_container 
            {
                position: relative;
                width: 100%;
                height: 100%;
                top: 0;
                right: 0;
                bottom: 0;
                left: 0;
                z-index: calc(9000 + 2);
                background-color: rgba(255,255,255,.75);
                visibility: visible;
                opacity: 1;
                transition: opacity .2s ease,visibility 0s;
                transition-delay: 0s,.3s;
            }          
        </style>
        
    </html>
    
</apex:page>