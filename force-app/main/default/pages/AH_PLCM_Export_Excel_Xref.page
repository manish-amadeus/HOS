<apex:page controller="AH_PLCM_Export_Report" standardstylesheets="false" contentType="{!ContentType}">
    <apex:outputText value="{!xlsHeader}" />
    <Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet" xmlns:html="http://www.w3.org/TR/REC-html40">
        <Styles>
            <Style ss:ID="Headers">
                <Alignment/>
                <Borders/>
                <Font ss:Bold="1"/>
                <Interior/>
                <NumberFormat/>
                <Protection/>
            </Style>
        </Styles>
        <Worksheet ss:Name="Transfer User Records">
            <Table x:FullColumns="1" x:FullRows="1">
                <Column ss:Width="130"/>
                <Column ss:Width="180"/>
                <Column ss:Width="180"/>
                <!--<Column ss:Width="150"/>-->
                <Column ss:Width="180"/>
                <Column ss:Width="180"/>
                <Row>
                    <Cell ss:StyleID="Headers"><Data ss:Type="String">Full Name</Data></Cell>
                    <Cell ss:StyleID="Headers"><Data ss:Type="String">Email</Data></Cell>
                    <apex:outputText rendered="{!totalAvailableLicences>0}">
                        <Cell ss:StyleID="Headers"><Data ss:Type="String">Transfer Records to (New User)</Data></Cell>
                    </apex:outputText>
                    <!--<Cell ss:StyleID="Headers"><Data ss:Type="String">New User's Property</Data></Cell> Date: 06/29/20-->
                    <Cell ss:StyleID="Headers"><Data ss:Type="String"><apex:outputText rendered="{!IsTargetUserExist}">Transfer Records to (Existing User)</apex:outputText></Data></Cell>
                    <Cell ss:StyleID="Headers"><Data ss:Type="String"><apex:outputText rendered="{!IsTargetUserExist}">Existing User's Email</apex:outputText></Data></Cell>
                </Row>
                <apex:repeat value="{!lstExportUserXrefs}" var="user"> 
                    <Row>
                        <Cell><Data ss:Type="String">{!user.Name}</Data></Cell>
                        <Cell><Data ss:Type="String">{!user.User_Email_Address__c}</Data></Cell>
                        <apex:outputText rendered="{!totalAvailableLicences>0}">
                            <Cell><Data ss:Type="String">{!user.MappedTo_User_Name__c}</Data></Cell>
                        </apex:outputText>
                        <!--<Cell><Data ss:Type="String">{!user.MappedTo_User_Property__c}</Data></Cell> Date: 06/29/20-->
                        <Cell><Data ss:Type="String"><apex:outputText rendered="{!IsTargetUserExist}">{!user.MappedTo_PLCM_TargetOrg_User__r.Name}</apex:outputText></Data></Cell>
                        <Cell><Data ss:Type="String"><apex:outputText rendered="{!IsTargetUserExist}">{!user.MappedTo_PLCM_TargetOrg_User__r.User_Email_Address__c}</apex:outputText></Data></Cell>
                    </Row>
                </apex:repeat>
            </Table>
        </Worksheet>
    </Workbook>
</apex:page>