<!-----------------------------------------------------------------------------------------------------------------------
Name            : NI_NeighborhoodExcelExport Visualforce Page
Author          : Stuart Emery
Created Date    : 3/28/2014
Last Mod Date   : 3/28/2014
Last Mod By     : Stuart Emery
NICC Reference  : NICC-009802
Description     : The NI_NeighborhoodExcelExport Visualforce page is in the "Neighborhood Community to export the Cases 
                : List Views to Excel.  
                              
------------------------------------------------------------------------------------------------------------------------->

<apex:page controller="NeighborhoodCaseCustomListView" id="page" showHeader="false" Sidebar="false" cache="true" expires="1200" contentType="application/vnd.ms-excel#NewmarketCases.xls" >
    <!-- Schema added to add autofilter for header row in Excel sheet -->
    <html xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40">
        <head></head> 
        <body > 
            <apex:pageBlock id="results" >
                
                <table border="1" cellpadding="1" cellspacing="0" style="width:100%;border:1px solid #000000;font-familyans-serif;font-size:10px">
                    <tr style="font-family:verdana;color:Black;font-size:12px;height=18px;width:100%" >  
                        <!-- Autofilter added for header row in Excel sheet -->
                        <td x:autofilter='all' style="background-color: #BCD6D3" ><b> <apex:outputText value="Case Number"  /></b> </td> 
                        <td x:autofilter='all' style="background-color: #BCD6D3" ><b><apex:outputText value="Alternate Case Number"/></b> </td> 
                        <td x:autofilter='all' style="background-color: #BCD6D3" ><b><apex:outputText value="Account Name"/></b> </td> 
                        <td x:autofilter='all' style="background-color: #BCD6D3" ><b><apex:outputText value="Contact Name"/></b></td> 
                        <td x:autofilter='all' style="background-color: #BCD6D3" ><b><apex:outputText value="Subject"/></b></td> 
                        <td x:autofilter='all' style="background-color: #BCD6D3" ><b><apex:outputText value="Date Opened"/></b></td>
                        <apex:outputPanel layout="none" rendered="{!bClosedCase}">
                        <td x:autofilter='all' style="background-color: #BCD6D3" ><b><apex:outputText value="Date Closed"/></b></td>
                        </apex:outputPanel>
                        <td x:autofilter='all' style="background-color: #BCD6D3" ><b><apex:outputText value="Status"/></b></td>
                        <td x:autofilter='all' style="background-color: #BCD6D3" ><b><apex:outputText value="Priority"/></b></td> 
                        <td x:autofilter='all' style="background-color: #BCD6D3" ><b><apex:outputText value="Product"/></b></td> 
                    </tr> 
                    <apex:repeat value="{!CasesExcelExport}" var="c" id="idCases"> 
                        <tr border="1" style="font-family:verdana;color:Black;font-size:12px;width:100%" > 
                            <td ><apex:outputText value="{!c.CaseNumber}"/></td> 
                            <td ><apex:outputText value="{!c.Previous_CaseNumber__c}"/></td> 
                            <td><apex:outputText value="{!c.Account.Name}"/></td> 
                            <td><apex:outputText value="{!c.Contact.Name}"/></td>           
                            <td><apex:outputText value="{!c.Subject}"/></td>
                            <td>
                                <apex:facet name="header">
                                    <apex:outputText value="Date Opened"/>
                                </apex:facet>             
                                <apex:outputText value="{0,date,MM'/'dd'/'yyyy}">
                                    <apex:param value="{!c.CreatedDate}"/>
                                </apex:outputText> 
                            </td>
                            <apex:outputPanel layout="none" rendered="{!bClosedCase}">
                            <td>
                                <apex:facet name="header">
                                    <apex:outputText value="Date Closed"/>
                                </apex:facet>             
                                <apex:outputText value="{0,date,MM'/'dd'/'yyyy}">
                                    <apex:param value="{!c.ClosedDate}"/>
                                </apex:outputText> 
                            </td>
                            </apex:outputPanel>
                            <td><apex:outputText value="{!c.Status}"/></td>
                            <td><apex:outputText value="{!c.Priority}"/></td>    
                            <td><apex:outputText value="{!c.DI_Product_Group__c}"/></td> 
                        </tr> 
                    </apex:repeat> 
                </table>
                <br/> <br/> <br/> <br/> <br/>

                <apex:outputtext > Confidential Information - Do Not Distribute</apex:outputtext>
                <br/>
                <apex:outputtext value="Newmarket Neighborhood My Cases Export" />
                <br/>
                <apex:outputtext >Generated By: {!$User.FirstName}  {!$User.LastName} {!localDt}</apex:outputtext>
                <br/>
                <apex:outputtext >View: {!selectedValue} </apex:outputtext>
                <br/>
                <apex:outputtext >Date Opened date range: {!startDate} - {!endDate} </apex:outputtext>
            </apex:pageBlock>
        </body >
    </html>
</apex:page>