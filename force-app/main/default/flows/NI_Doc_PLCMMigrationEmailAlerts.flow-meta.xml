<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <actionCalls>
        <description>Sends the email alert &quot;PLCM MeetingMatrix Migration 1 Day Reminder&quot;</description>
        <name>MeetingMatrix_Migration_1_Day_Reminder</name>
        <label>MeetingMatrix Migration 1 Day Reminder</label>
        <locationX>656</locationX>
        <locationY>199</locationY>
        <actionName>NI_Documentation__c.PLCM_MeetingMatrix_Migration_1_Day_Reminder</actionName>
        <actionType>emailAlert</actionType>
        <connector>
            <targetReference>GetTemplate2</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>SObjectRowId</name>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputParameters>
    </actionCalls>
    <actionCalls>
        <description>Sends the email alert &quot;PLCM MeetingMatrix Migration + 5 days&quot;</description>
        <name>MeetingMatrix_Migration_5_Day_Follow_Up</name>
        <label>MeetingMatrix Migration 5 Day Follow Up</label>
        <locationX>663</locationX>
        <locationY>42</locationY>
        <actionName>NI_Documentation__c.PLCM_MeetingMatrix_Migration_Plus_5_Days</actionName>
        <actionType>emailAlert</actionType>
        <connector>
            <targetReference>GetTemplate4</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>SObjectRowId</name>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputParameters>
    </actionCalls>
    <actionCalls>
        <description>Sends the email alert &quot;PLCM MeetingMatrix Migration Complete&quot;</description>
        <name>MeetingMatrix_Migration_Complete</name>
        <label>MeetingMatrix Migration Complete</label>
        <locationX>430</locationX>
        <locationY>322</locationY>
        <actionName>NI_Documentation__c.PLCM_MeetingMatrix_Migration_Complete</actionName>
        <actionType>emailAlert</actionType>
        <connector>
            <targetReference>GetTemplate3</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>SObjectRowId</name>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputParameters>
    </actionCalls>
    <actionCalls>
        <description>Sends the email alert &quot;PLCM MeetingMatrix Migration Date Scheduled&quot;</description>
        <name>MeetingMatrix_Migration_Date_Scheduled</name>
        <label>MeetingMatrix Migration Date Scheduled</label>
        <locationX>404</locationX>
        <locationY>472</locationY>
        <actionName>NI_Documentation__c.PLCM_MeetingMatrix_Migration_Date_Scheduled</actionName>
        <actionType>emailAlert</actionType>
        <connector>
            <targetReference>GetTemplate1</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>SObjectRowId</name>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputParameters>
    </actionCalls>
    <apiVersion>55.0</apiVersion>
    <decisions>
        <description>Decides if the record is a new record or if the Migration Progress field has changed to &quot;Migration Complete&quot;.</description>
        <name>NewRecordOrMigrationCompleteDecision</name>
        <label>NewRecordOrMigrationCompleteDecision</label>
        <locationX>161</locationX>
        <locationY>395</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>MigrationScheduledMeetingMatrix</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.AH_PLCM_Product__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Meeting Matrix Conversion</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.AH_PLCM_Migration_Date__c</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.AH_PLCM_Migration_Date__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>MeetingMatrix_Migration_Date_Scheduled</targetReference>
            </connector>
            <label>MigrationScheduledMeetingMatrix</label>
        </rules>
        <rules>
            <name>MigrationCompleteMeetingMatrix</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.AH_PLCM_MigrationProgress__c</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.AH_PLCM_MigrationProgress__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Migration Complete</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.AH_PLCM_Product__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Meeting Matrix Conversion</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>MeetingMatrix_Migration_Complete</targetReference>
            </connector>
            <label>MigrationCompleteMeetingMatrix</label>
        </rules>
    </decisions>
    <decisions>
        <description>Decides which product the record is for</description>
        <name>ReminderEmailProductDecision</name>
        <label>ReminderEmailProductDecision</label>
        <locationX>506</locationX>
        <locationY>119</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>MeetingMatrixDayBefore</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.AH_PLCM_Product__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Meeting Matrix Conversion</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.AH_PLCM_Migration_Reminder_2_Date__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>MeetingMatrix_Migration_1_Day_Reminder</targetReference>
            </connector>
            <label>MeetingMatrixDayBefore</label>
        </rules>
        <rules>
            <name>MeetingMatrix5Days</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.AH_PLCM_Product__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Meeting Matrix Conversion</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.AH_PLCM_Migration_Reminder_3_Date__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>MeetingMatrix_Migration_5_Day_Follow_Up</targetReference>
            </connector>
            <label>MeetingMatrix5Days</label>
        </rules>
    </decisions>
    <description>NICC-061820; Automation to send out Email Alerts for PLCM MeetingMatrix Migration projects</description>
    <environments>Default</environments>
    <interviewLabel>NI Doc - PLCM Migration Email Alerts {!$Flow.CurrentDateTime}</interviewLabel>
    <label>NI Doc - PLCM Migration Email Alerts</label>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>FREE_FORM_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordCreates>
        <description>Creates an additional &quot;migration date + 5 days&quot; email to associate with the Project and Project Contact</description>
        <name>CreateEmail5DayReminder</name>
        <label>CreateEmail5DayReminder</label>
        <locationX>954</locationX>
        <locationY>96</locationY>
        <inputAssignments>
            <field>CcAddress</field>
            <value>
                <elementReference>$Record.AH_PLCM_Project_Contact__r.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>FromAddress</field>
            <value>
                <stringValue>hospitality.plcm@amadeus.com</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>FromName</field>
            <value>
                <stringValue>MeetingMatrix Migration Team</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>HtmlBody</field>
            <value>
                <elementReference>GetTemplate4.HtmlValue</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>MessageDate</field>
            <value>
                <elementReference>$Flow.CurrentDateTime</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>RelatedToId</field>
            <value>
                <elementReference>$Record.Project__r.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Status</field>
            <value>
                <stringValue>3</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Subject</field>
            <value>
                <elementReference>GetTemplate4.Subject</elementReference>
            </value>
        </inputAssignments>
        <object>EmailMessage</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <description>Creates an additional &quot;day before migration&quot; email to associate with the Project and Project Contact</description>
        <name>CreateEmailDayBeforeReminder</name>
        <label>CreateEmailDayBeforeReminder</label>
        <locationX>936</locationX>
        <locationY>266</locationY>
        <inputAssignments>
            <field>CcAddress</field>
            <value>
                <elementReference>$Record.AH_PLCM_Project_Contact__r.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>FromAddress</field>
            <value>
                <stringValue>hospitality.plcm@amadeus.com</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>FromName</field>
            <value>
                <stringValue>MeetingMatrix Migration Team</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>HtmlBody</field>
            <value>
                <elementReference>GetTemplate2.HtmlValue</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>MessageDate</field>
            <value>
                <elementReference>$Flow.CurrentDateTime</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>RelatedToId</field>
            <value>
                <elementReference>$Record.Project__r.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Status</field>
            <value>
                <stringValue>3</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Subject</field>
            <value>
                <elementReference>GetTemplate2.Subject</elementReference>
            </value>
        </inputAssignments>
        <object>EmailMessage</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <description>Creates an additional &quot;migration complete&quot; email to associate with the Project and Project Contact</description>
        <name>CreateEmailMigrationComplete</name>
        <label>CreateEmailMigrationComplete</label>
        <locationX>735</locationX>
        <locationY>352</locationY>
        <inputAssignments>
            <field>CcAddress</field>
            <value>
                <elementReference>$Record.AH_PLCM_Project_Contact__r.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>FromAddress</field>
            <value>
                <stringValue>hospitality.plcm@amadeus.com</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>FromName</field>
            <value>
                <stringValue>MeetingMatrix Migration Team</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>HtmlBody</field>
            <value>
                <elementReference>GetTemplate3.HtmlValue</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>MessageDate</field>
            <value>
                <elementReference>$Flow.CurrentDateTime</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>RelatedToId</field>
            <value>
                <elementReference>$Record.Project__r.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Status</field>
            <value>
                <stringValue>3</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Subject</field>
            <value>
                <elementReference>GetTemplate3.Subject</elementReference>
            </value>
        </inputAssignments>
        <object>EmailMessage</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <description>Creates an additional &quot;migration scheduled&quot; email message to associate with the Project and Project Contact</description>
        <name>CreateEmailMigrationScheduled</name>
        <label>CreateEmailMigrationScheduled</label>
        <locationX>769</locationX>
        <locationY>528</locationY>
        <inputAssignments>
            <field>CcAddress</field>
            <value>
                <elementReference>$Record.AH_PLCM_Project_Contact__r.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>FromAddress</field>
            <value>
                <stringValue>hospitality.plcm@amadeus.com</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>FromName</field>
            <value>
                <stringValue>MeetingMatrix Migration Team</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>HtmlBody</field>
            <value>
                <elementReference>GetTemplate1.HtmlValue</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>MessageDate</field>
            <value>
                <elementReference>$Flow.CurrentDateTime</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>RelatedToId</field>
            <value>
                <elementReference>$Record.Project__r.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Status</field>
            <value>
                <stringValue>3</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Subject</field>
            <value>
                <elementReference>GetTemplate1.Subject</elementReference>
            </value>
        </inputAssignments>
        <object>EmailMessage</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordLookups>
        <description>Gets the Lightning Email template for the &quot;migration scheduled&quot; email alert</description>
        <name>GetTemplate1</name>
        <label>GetTemplate1</label>
        <locationX>550</locationX>
        <locationY>494</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>CreateEmailMigrationScheduled</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>DeveloperName</field>
            <operator>StartsWith</operator>
            <value>
                <stringValue>PLCM_MM_Tech_Transfer_Email1</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>EmailTemplate</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <description>Gets the lightning email template for the &quot;day before migration&quot; email alert</description>
        <name>GetTemplate2</name>
        <label>GetTemplate2</label>
        <locationX>789</locationX>
        <locationY>224</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>CreateEmailDayBeforeReminder</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>DeveloperName</field>
            <operator>StartsWith</operator>
            <value>
                <stringValue>PLCM_MM_Tech_Transfer_Email2</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>EmailTemplate</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <description>Gets the lightning email template for &quot;migration complete&quot; email alert</description>
        <name>GetTemplate3</name>
        <label>GetTemplate3</label>
        <locationX>573</locationX>
        <locationY>342</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>CreateEmailMigrationComplete</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>DeveloperName</field>
            <operator>StartsWith</operator>
            <value>
                <stringValue>PLCM_MM_Tech_Transfer_Email3</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>EmailTemplate</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <description>Gets the lightning email template for the &quot;migration date + 5 days&quot; email alert</description>
        <name>GetTemplate4</name>
        <label>GetTemplate4</label>
        <locationX>812</locationX>
        <locationY>58</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>CreateEmail5DayReminder</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>DeveloperName</field>
            <operator>StartsWith</operator>
            <value>
                <stringValue>PLCM_MM_Tech_Transfer_Email4</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>EmailTemplate</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <start>
        <locationX>68</locationX>
        <locationY>48</locationY>
        <connector>
            <targetReference>NewRecordOrMigrationCompleteDecision</targetReference>
        </connector>
        <filterFormula>{!$Record.RecordType.DeveloperName} = &quot;PLCM_Migrations&quot; &amp;&amp;
ISPICKVAL({!$Record.AH_PLCM_Product__c}, &quot;Meeting Matrix Conversion&quot;) &amp;&amp;
{!$Record.Stop_Email_Notifications__c}= FALSE</filterFormula>
        <object>NI_Documentation__c</object>
        <recordTriggerType>CreateAndUpdate</recordTriggerType>
        <scheduledPaths>
            <name>DayBeforeMigration</name>
            <connector>
                <targetReference>ReminderEmailProductDecision</targetReference>
            </connector>
            <label>DayBeforeMigration</label>
            <offsetNumber>0</offsetNumber>
            <offsetUnit>Days</offsetUnit>
            <recordField>AH_PLCM_Migration_Reminder_2_Date__c</recordField>
            <timeSource>RecordField</timeSource>
        </scheduledPaths>
        <scheduledPaths>
            <name>Migration_5Days</name>
            <connector>
                <targetReference>ReminderEmailProductDecision</targetReference>
            </connector>
            <label>Migration+5Days</label>
            <offsetNumber>0</offsetNumber>
            <offsetUnit>Days</offsetUnit>
            <recordField>AH_PLCM_Migration_Reminder_3_Date__c</recordField>
            <timeSource>RecordField</timeSource>
        </scheduledPaths>
        <triggerType>RecordAfterSave</triggerType>
    </start>
    <status>Active</status>
</Flow>
