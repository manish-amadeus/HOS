<?xml version="1.0" encoding="UTF-8"?>
<Workflow xmlns="http://soap.sforce.com/2006/04/metadata">
    <alerts>
        <fullName>Data_Extraction_Sku_has_been_added_to_an_Opportunity</fullName>
        <description>Data Extraction Sku has been added to an Opportunity</description>
        <protected>false</protected>
        <recipients>
            <recipient>rspear@newmarketinc.com</recipient>
            <type>user</type>
        </recipients>
        <senderType>CurrentUser</senderType>
        <template>unfiled$public/Data_Extraction_Sku</template>
    </alerts>
    <alerts>
        <fullName>Email_with_Data_Extraction_Sku_Over_75</fullName>
        <description>Email with Data Extraction Sku Over 75%</description>
        <protected>false</protected>
        <recipients>
            <recipient>jpriester@newmarketinc.com</recipient>
            <type>user</type>
        </recipients>
        <recipients>
            <recipient>rspear@newmarketinc.com</recipient>
            <type>user</type>
        </recipients>
        <senderType>CurrentUser</senderType>
        <template>unfiled$public/Data_Extraction_Sku_over_75</template>
    </alerts>
    <alerts>
        <fullName>HIS_Order_Complete_Email_Notification</fullName>
        <description>HIS Order Complete Email Notification</description>
        <protected>false</protected>
        <recipients>
            <recipient>jpriester@newmarketinc.com</recipient>
            <type>user</type>
        </recipients>
        <recipients>
            <recipient>semery@newmarketinc.com</recipient>
            <type>user</type>
        </recipients>
        <senderType>CurrentUser</senderType>
        <template>SalesMarketing/HIS_Order_Complete</template>
    </alerts>
    <alerts>
        <fullName>OpenHotHostingSkuinOpportunity</fullName>
        <description>OpenHot Hosting Sku in Opportunity</description>
        <protected>false</protected>
        <recipients>
            <recipient>dana.daigle@amadeus.com</recipient>
            <type>user</type>
        </recipients>
        <senderType>CurrentUser</senderType>
        <template>NISalesWorkflowEmails/OpenHotClusterSOWNeeded</template>
    </alerts>
    <alerts>
        <fullName>Opportunity_Line_Item_Created_After_Closed_Date</fullName>
        <description>Opportunity Line Item Created After Closed Date</description>
        <protected>false</protected>
        <recipients>
            <recipient>semery@newmarketinc.com</recipient>
            <type>user</type>
        </recipients>
        <senderType>CurrentUser</senderType>
        <template>Opportunity_Product/New_Opportunity_Line_Item_Added_After_Close_Date</template>
    </alerts>
    <alerts>
        <fullName>SOWNeededOXIInterface</fullName>
        <description>SOW Needed - OXI Interface</description>
        <protected>false</protected>
        <recipients>
            <recipient>dokeefe@newmarketinc.com</recipient>
            <type>user</type>
        </recipients>
        <recipients>
            <recipient>jkrupp@newmarketinc.com</recipient>
            <type>user</type>
        </recipients>
        <recipients>
            <recipient>mallen@newmarketinc.com</recipient>
            <type>user</type>
        </recipients>
        <recipients>
            <recipient>rspear@newmarketinc.com</recipient>
            <type>user</type>
        </recipients>
        <senderType>CurrentUser</senderType>
        <template>NISalesWorkflowEmails/SOWNeededOXIInterface</template>
    </alerts>
    <alerts>
        <fullName>SOWNeededProductChanged</fullName>
        <description>SOW Needed - Product Changed</description>
        <protected>false</protected>
        <recipients>
            <recipient>dokeefe@newmarketinc.com</recipient>
            <type>user</type>
        </recipients>
        <recipients>
            <recipient>jkrupp@newmarketinc.com</recipient>
            <type>user</type>
        </recipients>
        <recipients>
            <recipient>mallen@newmarketinc.com</recipient>
            <type>user</type>
        </recipients>
        <recipients>
            <recipient>rspear@newmarketinc.com</recipient>
            <type>user</type>
        </recipients>
        <senderType>CurrentUser</senderType>
        <template>NISalesWorkflowEmails/ProductQuantityChangeforExistingOppty</template>
    </alerts>
    <alerts>
        <fullName>SendemailnotificationtoKathrynSimonds</fullName>
        <description>Send e-mail notification to Kathryn Simonds</description>
        <protected>false</protected>
        <recipients>
            <recipient>ksimonds@newmarketinc.com</recipient>
            <type>user</type>
        </recipients>
        <recipients>
            <recipient>semery@newmarketinc.com</recipient>
            <type>user</type>
        </recipients>
        <senderType>CurrentUser</senderType>
        <template>NISalesWorkflowEmails/CustomDevelopmentProject</template>
    </alerts>
    <fieldUpdates>
        <fullName>OppLineItem_Clear_Release_Date</fullName>
        <description>Salesforce.com Change Request: NICC-006223

Set the Release Date to a blank value</description>
        <field>Release_Date__c</field>
        <name>OppLineItem: Clear Release Date</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Null</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>OppLineItem_Release_Date_Today</fullName>
        <description>Salesforce.com Change Request: NICC-006223

Set the Release Date to today&apos;s date</description>
        <field>Release_Date__c</field>
        <formula>TODAY()</formula>
        <name>OppLineItem: Release Date - Today</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>OppProduct_Set_Release_Date_to_Clsd_Date</fullName>
        <description>Salesforce.com Change Request: NICC-008329

Sets the Release Date of the Opportunity Product to the Closed Date of the Opportunity</description>
        <field>Release_Date__c</field>
        <formula>Opportunity.CloseDate</formula>
        <name>OppProduct Set Release Date to Clsd Date</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>PSE_Set_IsServices_Flag_On_Opp_Products</fullName>
        <field>pse__IsServicesProductLine__c</field>
        <literalValue>1</literalValue>
        <name>PSE Set IsServices Flag On Opp Products</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Literal</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Update_Custom_ProductCode</fullName>
        <description>NICC-025259</description>
        <field>ProductCode__c</field>
        <formula>IF (PricebookEntry.Product2.ProductCode = &quot;CUSTOM-SERV-DISC&quot;, PricebookEntry.Product2.ProductCode, null)</formula>
        <name>Update Custom ProductCode</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Update_Solution_Domain</fullName>
        <description>NICC-028127</description>
        <field>Solution_Domain__c</field>
        <formula>text(Product2.Solution_Domain_Global__c)</formula>
        <name>Update Solution Domain</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <rules>
        <fullName>Edits made to opportunity</fullName>
        <actions>
            <name>SOWNeededProductChanged</name>
            <type>Alert</type>
        </actions>
        <active>true</active>
        <description>If the SOW needed is Markeed &quot;Yes&quot; and edits are made to the opportunity Producgts</description>
        <formula>OR(AND(ISCHANGED(Quantity),  ISPICKVAL( Opportunity.SOW_Needed__c ,&quot;Yes&quot;)),AND(Ischanged( Id ),ISPICKVAL( Opportunity.SOW_Needed__c ,&quot;Yes&quot;)))</formula>
        <triggerType>onAllChanges</triggerType>
    </rules>
    <rules>
        <fullName>OppProduct - Set Release Date New Product</fullName>
        <actions>
            <name>OppLineItem_Release_Date_Today</name>
            <type>FieldUpdate</type>
        </actions>
        <active>true</active>
        <description>Salesforce.com Change Request: NICC-006689

Updated Per Salesforce.com Change Request: NICC-012545

Set the &quot;Release Date&quot; to &quot;Today&apos;s Date&quot; when a new Opportunity Product is created on an Opportunity that has a Stage of &quot;Closed Won&quot;</description>
        <formula>AND(ISPICKVAL(Opportunity.StageName,&quot;Closed Won&quot;), $User.Alias != &quot;sledu&quot;,$User.Alias != &quot;j.force&quot;,  Opportunity.RecordType.Name != &quot;MTech Cancellation&quot;, Opportunity.RecordType.Name != &quot;MTech Incremental Opportunity&quot;, Opportunity.RecordType.Name != &quot;MTech New Opportunity&quot;)</formula>
        <triggerType>onCreateOnly</triggerType>
    </rules>
    <rules>
        <fullName>OppProduct - Set Release Date Subscription Management</fullName>
        <actions>
            <name>Opportunity_Line_Item_Created_After_Closed_Date</name>
            <type>Alert</type>
        </actions>
        <actions>
            <name>OppProduct_Set_Release_Date_to_Clsd_Date</name>
            <type>FieldUpdate</type>
        </actions>
        <active>true</active>
        <description>Salesforce.com Change Request: NICC-008329
Set the &quot;Release Date&quot; to the &quot;Closed Date&quot; of the Opportunity when a new Opportunity Product is created on an Opportunity that has a Stage of &quot;Closed Won&quot;
Updated Per NICC-012545 to exclude MTech Record Types</description>
        <formula>AND(ISPICKVAL(Opportunity.StageName,&quot;Closed Won&quot;), $User.Alias = &quot;sledu&quot;,Opportunity.RecordType.Name != &quot;MTech Cancellation&quot;, Opportunity.RecordType.Name != &quot;MTech Incremental Opportunity&quot;, Opportunity.RecordType.Name != &quot;MTech New Opportunity&quot;)</formula>
        <triggerType>onCreateOnly</triggerType>
    </rules>
    <rules>
        <fullName>OppProduct%3A Clear Release Date</fullName>
        <actions>
            <name>OppLineItem_Clear_Release_Date</name>
            <type>FieldUpdate</type>
        </actions>
        <active>true</active>
        <description>Salesforce.com Change Request: NICC-006223

Set the Release Date to a blank value when the Deferred check box is checked</description>
        <formula>AND(ISCHANGED(Deferred__c), Deferred__c = true)</formula>
        <triggerType>onAllChanges</triggerType>
    </rules>
    <rules>
        <fullName>OppProduct%3A Set Release Date to Current Date</fullName>
        <actions>
            <name>OppLineItem_Release_Date_Today</name>
            <type>FieldUpdate</type>
        </actions>
        <active>true</active>
        <description>Salesforce.com Change Request: NICC-006223

Set the Release Date to the current date when the Deferred check box is un-checked

Updated per NICC-012545 to exclude MTech Record Types</description>
        <formula>AND(ISCHANGED(Deferred__c), Deferred__c = false, Opportunity.RecordType.Name != &quot;MTech Cancellation&quot;, Opportunity.RecordType.Name != &quot;MTech Incremental Opportunity&quot;, Opportunity.RecordType.Name != &quot;MTech New Opportunity&quot;)</formula>
        <triggerType>onAllChanges</triggerType>
    </rules>
    <rules>
        <fullName>Opportunity Product was Created or Updated</fullName>
        <actions>
            <name>Update_Custom_ProductCode</name>
            <type>FieldUpdate</type>
        </actions>
        <active>true</active>
        <description>NICC-025259</description>
        <formula>OR (     ISNEW(),     PRIORVALUE(Id) = Id )</formula>
        <triggerType>onAllChanges</triggerType>
    </rules>
    <rules>
        <fullName>PSE Set Opportunity Product IsServicesProductLine Flag</fullName>
        <actions>
            <name>PSE_Set_IsServices_Flag_On_Opp_Products</name>
            <type>FieldUpdate</type>
        </actions>
        <active>true</active>
        <criteriaItems>
            <field>Product2.pse__IsServicesProduct__c</field>
            <operation>equals</operation>
            <value>True</value>
        </criteriaItems>
        <description>This workflow will look at the product that has been added to the opportunity product line item. If the product is a services product it will check the check box on the opportunity product line item.</description>
        <triggerType>onCreateOrTriggeringUpdate</triggerType>
    </rules>
    <rules>
        <fullName>Send Email to Rich Spear for Data Extract Sku</fullName>
        <actions>
            <name>Data_Extraction_Sku_has_been_added_to_an_Opportunity</name>
            <type>Alert</type>
        </actions>
        <active>true</active>
        <criteriaItems>
            <field>OpportunityLineItem.ProductCode</field>
            <operation>equals</operation>
            <value>DEL-DS-06</value>
        </criteriaItems>
        <triggerType>onCreateOrTriggeringUpdate</triggerType>
    </rules>
    <rules>
        <fullName>Send Email to Rich Spear for Data Extract Sku w 80%25</fullName>
        <actions>
            <name>Email_with_Data_Extraction_Sku_Over_75</name>
            <type>Alert</type>
        </actions>
        <active>true</active>
        <criteriaItems>
            <field>OpportunityLineItem.ProductCode</field>
            <operation>equals</operation>
            <value>DEL-DS-06</value>
        </criteriaItems>
        <criteriaItems>
            <field>Opportunity.Probability</field>
            <operation>greaterThan</operation>
            <value>75</value>
        </criteriaItems>
        <triggerType>onCreateOrTriggeringUpdate</triggerType>
    </rules>
    <rules>
        <fullName>Trigger HIS when Order is Definite</fullName>
        <actions>
            <name>HIS_Order_Complete_Email_Notification</name>
            <type>Alert</type>
        </actions>
        <active>true</active>
        <criteriaItems>
            <field>OpportunityLineItem.ProductCode</field>
            <operation>startsWith</operation>
            <value>HIS</value>
        </criteriaItems>
        <criteriaItems>
            <field>Opportunity.Order_Status__c</field>
            <operation>equals</operation>
            <value>Definite</value>
        </criteriaItems>
        <description>When an order turns definite, trigger HIS Opperations that they can activate account.</description>
        <triggerType>onAllChanges</triggerType>
    </rules>
    <rules>
        <fullName>Update Solution Domain</fullName>
        <actions>
            <name>Update_Solution_Domain</name>
            <type>FieldUpdate</type>
        </actions>
        <active>true</active>
        <description>NICC-028127: Update Solution Domain Field from the related product</description>
        <formula>Solution_Domain__c != TEXT(Product2.Solution_Domain_Global__c )</formula>
        <triggerType>onCreateOrTriggeringUpdate</triggerType>
    </rules>
</Workflow>
