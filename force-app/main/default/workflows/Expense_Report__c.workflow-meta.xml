<?xml version="1.0" encoding="UTF-8"?>
<Workflow xmlns="http://soap.sforce.com/2006/04/metadata">
    <alerts>
        <fullName>Alert_of_Blank_Manager_Field</fullName>
        <ccEmails>trackitmail@newmarketinc.com</ccEmails>
        <description>Alert of Blank Manager Field</description>
        <protected>false</protected>
        <recipients>
            <type>owner</type>
        </recipients>
        <senderType>CurrentUser</senderType>
        <template>Sales_Expense_Reports/Alert_of_Blank_Manager_Field</template>
    </alerts>
    <alerts>
        <fullName>ExpenseReportRecalled</fullName>
        <description>Expense Report Recalled</description>
        <protected>false</protected>
        <recipients>
            <recipient>wmurphy@newmarketinc.com</recipient>
            <type>user</type>
        </recipients>
        <senderType>CurrentUser</senderType>
        <template>SalesMarketing/Expense_Report_Recalled</template>
    </alerts>
    <alerts>
        <fullName>ExpenseReporthasbeenApprovedToOwner</fullName>
        <description>Expense Report has been Approved - To Owner</description>
        <protected>false</protected>
        <recipients>
            <type>owner</type>
        </recipients>
        <senderType>CurrentUser</senderType>
        <template>SalesMarketing/Expense_Report_has_been_Approved</template>
    </alerts>
    <alerts>
        <fullName>Expense_Report_has_been_Rejected_To_Owner</fullName>
        <description>Expense Report has been Rejected - To Owner</description>
        <protected>false</protected>
        <recipients>
            <type>owner</type>
        </recipients>
        <senderType>CurrentUser</senderType>
        <template>LOD_Sales_Marketing/Expense_Report_has_been_Rejected</template>
    </alerts>
    <alerts>
        <fullName>Expense_Report_to_be_Approved</fullName>
        <description>Expense Report to be Approved</description>
        <protected>false</protected>
        <recipients>
            <field>Final_Approver__c</field>
            <type>userLookup</type>
        </recipients>
        <senderType>CurrentUser</senderType>
        <template>Sales_Expense_Reports/Expense_Report_Submitted_For_Approval</template>
    </alerts>
    <alerts>
        <fullName>Expense_Report_to_be_Approved2</fullName>
        <description>Expense Report to be Approved</description>
        <protected>false</protected>
        <recipients>
            <field>Final_Approver__c</field>
            <type>userLookup</type>
        </recipients>
        <senderType>CurrentUser</senderType>
        <template>SalesMarketing/Expense_Report_Approval_Email</template>
    </alerts>
    <alerts>
        <fullName>Expense_Report_to_be_Reviewed_Whitney</fullName>
        <description>Expense Report to be Reviewed - Whitney</description>
        <protected>false</protected>
        <recipients>
            <recipient>lertle@newmarketinc.com</recipient>
            <type>user</type>
        </recipients>
        <recipients>
            <recipient>wmurphy@newmarketinc.com</recipient>
            <type>user</type>
        </recipients>
        <senderType>CurrentUser</senderType>
        <template>Sales_Expense_Reports/Expense_Report_Submitted_For_Approval_For_Whitney</template>
    </alerts>
    <alerts>
        <fullName>Rejectionnotification_SO_Dev</fullName>
        <description>Rejection notification - SO Dev</description>
        <protected>false</protected>
        <recipients>
            <recipient>michelle.rocholl@amadeus.com</recipient>
            <type>user</type>
        </recipients>
        <senderType>CurrentUser</senderType>
        <template>SalesMarketing/Whitney_Rejection_notification</template>
    </alerts>
    <alerts>
        <fullName>Sales_Expense_Report_Owner_Missing_ADP_Record_Number</fullName>
        <ccEmails>payroll@newmarketinc.com</ccEmails>
        <description>Sales Expense Report Owner - Missing ADP Record Number</description>
        <protected>false</protected>
        <recipients>
            <recipient>semery@newmarketinc.com</recipient>
            <type>user</type>
        </recipients>
        <senderType>CurrentUser</senderType>
        <template>Sales_Expense_Reports/MIssing_ADP_Number</template>
    </alerts>
    <alerts>
        <fullName>Sales_Expense_Report_Owner_Missing_Department_Code_and_Financial_Location_Segmen</fullName>
        <description>Sales Expense Report Owner - Missing Department Code and Financial Location/Segment</description>
        <protected>false</protected>
        <recipients>
            <recipient>lertle@newmarketinc.com</recipient>
            <type>user</type>
        </recipients>
        <recipients>
            <recipient>semery@newmarketinc.com</recipient>
            <type>user</type>
        </recipients>
        <senderType>CurrentUser</senderType>
        <template>Sales_Expense_Reports/User_Missing_Department_or_Location</template>
    </alerts>
    <fieldUpdates>
        <fullName>ChangeStatustoNotSubmitted</fullName>
        <field>Status__c</field>
        <literalValue>Not Submitted</literalValue>
        <name>Change Status to Not Submitted</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Literal</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>ChangeStatustoSubmitted</fullName>
        <field>Status__c</field>
        <literalValue>Submitted</literalValue>
        <name>Change Status to Submitted</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Literal</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Change_Status_to_Approved_Step_1</fullName>
        <field>Status__c</field>
        <literalValue>Approved (Step #1)</literalValue>
        <name>Change Status to Approved Step #1</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Literal</operation>
        <protected>false</protected>
        <reevaluateOnChange>true</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Date_Approved</fullName>
        <description>Salesforce.com Change Request: NICC-013688

Update the Date Approved field with the current date and time</description>
        <field>Date_Approved__c</field>
        <formula>NOW()</formula>
        <name>Date Approved</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Libra_ER_Status_set_to_In_Progress</fullName>
        <field>lod_status__c</field>
        <literalValue>In Progress</literalValue>
        <name>Libra ER Status set to In Progress</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Literal</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Libra_Exp_Report_Status_to_Submitted</fullName>
        <field>lod_status__c</field>
        <literalValue>Submitted</literalValue>
        <name>Libra Exp Report Status to Submitted</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Literal</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Set_LOD_ER_Status_to_approved</fullName>
        <field>lod_status__c</field>
        <literalValue>Approved</literalValue>
        <name>Set LOD ER Status to approved</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Literal</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Set_LOD_ER_Status_to_rejected</fullName>
        <field>lod_status__c</field>
        <literalValue>Rejected</literalValue>
        <name>Set LOD ER Status to rejected</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Literal</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Set_Status_to_Approved</fullName>
        <field>Status__c</field>
        <literalValue>Approved</literalValue>
        <name>Set Status to Approved</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Literal</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>StatusUpdatetoApproved2</fullName>
        <field>Status__c</field>
        <literalValue>Approved (Step #2)</literalValue>
        <name>Status Update to Approved #2</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Literal</operation>
        <protected>false</protected>
        <reevaluateOnChange>true</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Statuschangetorejected</fullName>
        <field>Status__c</field>
        <literalValue>Rejected</literalValue>
        <name>Status change to rejected</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Literal</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>StatustoRejected</fullName>
        <field>Status__c</field>
        <literalValue>Rejected</literalValue>
        <name>Status to Rejected</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Literal</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Statusupdatedtoapproved</fullName>
        <field>Status__c</field>
        <literalValue>Approved</literalValue>
        <name>Status updated to approved</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Literal</operation>
        <protected>false</protected>
        <reevaluateOnChange>true</reevaluateOnChange>
    </fieldUpdates>
    <rules>
        <fullName>Owner ADP Number Missing</fullName>
        <actions>
            <name>Sales_Expense_Report_Owner_Missing_ADP_Record_Number</name>
            <type>Alert</type>
        </actions>
        <active>true</active>
        <description>Salesforce.com Change Request: NICC-013870: 
Sends an e-mail to payroll@newmarketinc.com and accountspayable@newmarketinc.com 
when a Sales Expense Record is created and the Owner of the record does not have an ADP Number in Salesforce.</description>
        <formula>ISBLANK(Owner:User.ADP_Record_Number__c)</formula>
        <triggerType>onCreateOnly</triggerType>
    </rules>
    <rules>
        <fullName>Owner Missing Department Code and Location</fullName>
        <actions>
            <name>Sales_Expense_Report_Owner_Missing_Department_Code_and_Financial_Location_Segmen</name>
            <type>Alert</type>
        </actions>
        <active>true</active>
        <description>Salesforce.com Change Request: NICC-013870: 
Sends an e-mail to ithelpdesk@newmarketinc.com 
when a Sales Expense Record is created and the Owner of the record does not have the Department Code or Financial Location field filled in</description>
        <formula>OR(ISBLANK(Owner:User.DepartmentCode__c),ISBLANK( Owner:User.NI_Location__c))</formula>
        <triggerType>onCreateOnly</triggerType>
    </rules>
    <rules>
        <fullName>Update Date Approved Field</fullName>
        <actions>
            <name>Date_Approved</name>
            <type>FieldUpdate</type>
        </actions>
        <active>true</active>
        <description>Salesforce.com Change Request: NICC-013688: 
Update the &quot;Date Approved&quot; field 
when the Status is set to one of the &quot;Approved&quot; options.</description>
        <formula>ISCHANGED(Status__c)
&amp;&amp;
(
ISPICKVAL(Status__c,&quot;Approved&quot;)
||
ISPICKVAL(Status__c,&quot;Approved (Step #1)&quot;)
||
ISPICKVAL(Status__c,&quot;Approved (Step #2)&quot;)
)</formula>
        <triggerType>onAllChanges</triggerType>
    </rules>
    <tasks>
        <fullName>ExpenseReporthasbeenrejected</fullName>
        <assignedTo>wmurphy@newmarketinc.com</assignedTo>
        <assignedToType>user</assignedToType>
        <description>The expense report related to this task has been rejected. The approval history will contain the comments for the rejection. Please follow up with the expense report owner. 

Thank you!</description>
        <dueDateOffset>2</dueDateOffset>
        <notifyAssignee>true</notifyAssignee>
        <priority>Normal - 2 Days</priority>
        <protected>false</protected>
        <status>In Progress</status>
        <subject>Expense Report has been rejected</subject>
    </tasks>
</Workflow>
